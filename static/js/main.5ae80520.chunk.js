(this["webpackJsonpchrome-ext"]=this["webpackJsonpchrome-ext"]||[]).push([[0],{26:function(t,e,n){},39:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n.n(i),c=n(6),r=n.n(c),s=(n(26),n(3)),d=Object(i.createContext)(null),a=function(){var t=Object(i.useContext)(d);if(!t)throw new Error("Widget not found");return t},u=n(1),l=Object(s.a)((function(){var t=a();return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("textarea",{style:{backgroundColor:"inherit",fontFamily:"inherit",color:"inherit",border:0,resize:"none",width:"100%",height:"100%",padding:16,margin:0,outline:0},value:t.content.data,onChange:function(e){return t.setContentData(e.currentTarget.value)}})})})),h=Object(s.a)((function(){var t,e=a(),n=e.content.data,o=(t=n.lastRequested,(Date.now()-t)/6e4>60);return Object(i.useEffect)((function(){o&&fetch("https://api.quotable.io/random").then((function(t){return t.ok?t.json():Promise.reject()})).then((function(t){var n=t.content,i=t.author;e.setContentData({author:i,content:n,lastRequested:Date.now()})})).catch((function(){console.warn("Failed to fetch quote!")}))}),[o]),!n.content||o?Object(u.jsx)("div",{}):Object(u.jsxs)("div",{style:{width:"80%",margin:"auto"},children:[Object(u.jsxs)("p",{children:['"',n.content,'"']}),Object(u.jsxs)("p",{children:["- ",n.author]})]})})),f=n(5),j=function(t,e){var n=Object(i.useRef)(t);Object(i.useEffect)((function(){n.current=t}),[t]),Object(i.useEffect)((function(){var t=setInterval(n.current,e);return function(){return clearInterval(t)}}),[e])},b="en-US",g={weekday:"short",day:"numeric",year:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,e=t.toLocaleString(b,g),n=e.lastIndexOf(",");return{date:e.substring(0,n),time:e.substring(n+1).trim()}},v=function(){var t=Object(i.useState)((function(){return O()})),e=Object(f.a)(t,2),n=e[0],o=n.date,c=n.time,r=e[1];return j((function(){return r(O())}),1e3),Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"date",children:o}),Object(u.jsx)("div",{className:"time",children:c})]})},w=Array.from("\ud83d\ude0e\ud83e\udd20\ud83e\udd18\ud83d\ude3a\ud83d\ude0a\ud83d\ude01\ud83e\udd16\ud83d\ude0c\ud83e\udd19\ud83d\udc4a\ud83d\ude4b\ud83d\udc86\ud83c\udf1e\ud83c\udf1d\ud83d\udcab\ud83d\ude80"),x=function(){return w[Math.floor(Math.random()*w.length)]},m={note:l,quote:h,clock:v,emoji:function(){var t=Object(i.useState)(x),e=Object(f.a)(t,2),n=e[0],o=e[1];return Object(u.jsx)("div",{onClick:function(){return o(x)},style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",cursor:"pointer",fontSize:32,userSelect:"none"},children:Object(u.jsx)("h1",{children:n})})}},p=Object(s.a)((function(){var t=a(),e=m[t.content.type];return Object(u.jsx)("div",{className:"drag-box_content",children:Object(u.jsx)(e,{})})})),y=n(19),S=n.n(y),k=function(t){var e=t.children,n=t.onClick,i=t.color;return Object(u.jsx)("div",{className:"drag-box_header-button ".concat(i),onMouseDown:function(t){return t.stopPropagation()},onClick:n,children:Object(u.jsx)("div",{children:e})})},C=Object(s.a)((function(){var t=a(),e=Object(i.useState)(0),n=Object(f.a)(e,2),o=n[0],c=n[1],r="title_".concat(t.id);return Object(u.jsxs)("div",{className:"drag-box_header",children:[Object(u.jsx)(S.a,{id:r,className:"drag-box_title",value:t.content.title,onMouseDown:function(t){var e;(null===(e=document.activeElement)||void 0===e?void 0:e.id)===r?(t.stopPropagation(),c(0)):(t.preventDefault(),c(Date.now()))},onMouseUp:function(t){o&&Date.now()-o<200&&t.currentTarget.focus()},onChange:function(e){t.setContentTitle(e.currentTarget.value)},onBlur:function(e){if(!e.currentTarget.value){var n=t.content.type;t.setContentTitle("".concat(n[0].toUpperCase()).concat(n.slice(1)))}},maxLength:28,disabled:"note"!==t.content.type}),Object(u.jsxs)("div",{className:"drag-box_header-controls",children:[Object(u.jsx)(k,{color:"green",onClick:t.toggleFullScreen,children:"\u2194"}),Object(u.jsx)(k,{color:"red",onClick:t.delete,children:"\xd7"})]})]})})),D=function(){return{width:window.innerWidth,height:window.innerHeight}},N=Object(i.createContext)(D()),z=function(t){var e=t.children,n=Object(i.useState)(D),o=Object(f.a)(n,2),c=o[0],r=o[1];return Object(i.useEffect)((function(){var t=function(){return r(D)};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),Object(u.jsx)(N.Provider,{value:c,children:e})},A=n(20),E=n(10),F=n.n(E),M=Object(s.a)((function(t){var e=t.children,n=a(),o=n.position,c=n.size,r=Object(i.useRef)(null),s=Object(i.useContext)(N);Object(i.useEffect)((function(){var t=c.w>s.width-o.x?Math.max(0,s.width-c.w):o.x,e=c.h>s.height-o.y?Math.max(0,s.height-c.w):o.y,i=t?c.w:Math.max(200,Math.min(c.w,s.width-t)),r=e?c.h:Math.max(150,Math.min(c.h,s.height-e));n.setSize(i,r),n.setPosition(t,e)}),[s]);var d=n.isFullScreen?{x:0,y:0}:o,l=n.isFullScreen?{w:s.width,h:s.height}:c;return Object(u.jsx)(F.a,{bounds:"body",handle:".drag-box_header",nodeRef:r,onDrag:function(t,e){var i=e.x,o=e.y;return n.setPosition(i,o)},onMouseDown:n.setActive,position:d,disabled:n.isFullScreen,children:Object(u.jsx)("div",{ref:r,children:Object(u.jsx)(A.Resizable,{width:l.w,height:l.h,minConstraints:[200,150],onResize:function(t,e){var i=e.size;n.setSize(Math.min(i.width,s.width-o.x),Math.min(i.height,s.height-o.y))},children:Object(u.jsx)("div",{className:"drag-box ".concat(n.isFullScreen?"full":""),style:{width:l.w,height:l.h},children:e})})})})})),W=Object(s.a)((function(t){var e=t.widget;return Object(u.jsx)(d.Provider,{value:e,children:Object(u.jsxs)(M,{children:[Object(u.jsx)(C,{}),Object(u.jsx)(p,{})]})})})),q=n(7),T=n(11),I=n(2),_=n(4),P=n(41),R=function(){function t(e,n){var i=this;Object(q.a)(this,t),this.id=void 0,this.position=void 0,this.size=void 0,this.content=void 0,this.isSoftDeleted=void 0,this.isFullScreen=void 0,this.store=void 0,this.setPosition=function(t,e){i.position.x=t,i.position.y=e},this.setSize=function(t,e){i.size.w=t,i.size.h=e},this.setContentData=function(t){i.content.data=t},this.setContentTitle=function(t){i.content.title=t},this.setActive=function(){i.store.setActiveWidget(i.id)},this.toggleFullScreen=function(){i.isFullScreen=!i.isFullScreen},this.delete=function(){i.shouldSoftDelete?i.isSoftDeleted=!0:i.store.removeWidget(i.id)},this.restore=function(){i.setActive(),i.isSoftDeleted=!1},this.toJSON=function(){return{id:i.id,position:i.position,size:i.size,content:i.content,isSoftDeleted:i.isSoftDeleted,isFullScreen:i.isFullScreen}},this.id=n.id,this.position=n.position,this.size=n.size,this.content=n.content,this.isSoftDeleted=n.isSoftDeleted,this.isFullScreen=!!n.isFullScreen,this.store=e,Object(I.m)(this)}return Object(T.a)(t,[{key:"shouldSoftDelete",get:function(){return["clock","quote","emoji"].includes(this.content.type)}}]),t}();R.note=function(t){return new R(t,Object(_.a)(Object(_.a)({},R.defaults()),{},{content:{type:"note",title:"New Note",data:""}}))},R.quote=function(t){return new R(t,Object(_.a)(Object(_.a)({},R.defaults()),{},{content:{type:"quote",title:"Quote",data:{author:"",content:"",lastRequested:15e11}}}))},R.clock=function(t){return new R(t,Object(_.a)(Object(_.a)({},R.defaults()),{},{content:{type:"clock",title:"Clock",data:null}}))},R.emoji=function(t){return new R(t,Object(_.a)(Object(_.a)({},R.defaults()),{},{content:{type:"emoji",title:"Emoji",data:null}}))},R.defaults=function(){return{id:Object(P.a)(),size:{w:350,h:350},position:{x:10,y:10},isSoftDeleted:!1}};var B="__tabOS_widgets",J=new function t(){var e=this;Object(q.a)(this,t),this.getWidgets=function(){try{return JSON.parse(localStorage.getItem(B)||"[]")}catch(t){return console.warn("Error fetching stored widgets"),[]}},this.setWidgets=function(t){try{localStorage.setItem(B,t),console.log("Widgets saved!")}catch(e){}},this.listen=function(t){window.addEventListener("storage",(function(n){n.key===B&&t(e.getWidgets())}))}},L=n(21),Q=n.n(L),U=new(function(){function t(){var e=this;Object(q.a)(this,t),this.widgets=void 0,this.addNote=function(){e.addNew("note")},this.addQuote=function(){e.restoreOrAddNew("quote")},this.addClock=function(){e.restoreOrAddNew("clock")},this.addEmoji=function(){e.restoreOrAddNew("emoji")},this.setActiveWidget=function(t){var n=e.findIndex(t);n>-1&&e.widgets.push(e.widgets.splice(n,1)[0])},this.removeWidget=function(t){var n=e.findIndex(t);n>-1&&e.widgets.splice(n,1)},this.findIndex=function(t){return e.widgets.findIndex((function(e){return e.id===t}))},this.findByType=function(t){return e.widgets.find((function(e){return e.content.type===t}))},this.serialize=function(t){return new R(e,t)},this.restoreOrAddNew=function(t){var n=e.findByType(t);n&&n.isSoftDeleted?n.restore():e.addNew(t)},this.addNew=function(t){e.widgets.push(R[t](e))},Object(I.m)(this),this.widgets=J.getWidgets().map(this.serialize),J.listen(Object(I.f)((function(t){e.widgets=t.map(e.serialize)}))),Object(I.p)((function(){return e.json}),Q()(J.setWidgets,1500))}return Object(T.a)(t,[{key:"displayedWidgets",get:function(){return this.widgets.filter((function(t){return!t.isSoftDeleted}))}},{key:"canAddNote",get:function(){return this.widgets.filter((function(t){return"note"===t.content.type})).length<3}},{key:"canAddQuote",get:function(){var t=this.findByType("quote");return!t||t.isSoftDeleted}},{key:"canAddClock",get:function(){var t=this.findByType("clock");return!t||t.isSoftDeleted}},{key:"canAddEmoji",get:function(){var t=this.findByType("emoji");return!t||t.isSoftDeleted}},{key:"json",get:function(){return JSON.stringify(this.widgets)}}]),t}());var H=Object(s.a)((function(){return Object(u.jsxs)("div",{className:"app",children:[Object(u.jsx)("button",{onClick:U.addNote,disabled:!U.canAddNote,children:"note"}),Object(u.jsx)("button",{onClick:U.addClock,disabled:!U.canAddClock,children:"clock"}),Object(u.jsx)("button",{onClick:U.addQuote,disabled:!U.canAddQuote,children:"quote"}),Object(u.jsx)("button",{onClick:U.addEmoji,disabled:!U.canAddEmoji,children:"emoji"}),U.displayedWidgets.map((function(t){return Object(u.jsx)(W,{widget:t},t.id)}))]})}));r.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(z,{children:Object(u.jsx)(H,{})})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.5ae80520.chunk.js.map